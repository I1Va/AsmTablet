Turbo Assembler	 Version 4.1	    02/11/25 19:44:49	    Page 1
tablet.asm



      1	0000			     .model tiny
      2				     .186
      3				     locals @@
      4
      5	0000			     .data
      6
      7	      =B800		     VIDEOSEG equ 0b800h
      8	0000  53 77 65 65 74 20	46+  tablet_string db 'Sweet February with Valentine!$'
      9	      65 62 72 75 61 72	79+
     10	      20 77 69 74 68 20	56+
     11	      61 6C 65 6E 74 69	6E+
     12	      65 21 24
     13	001F  2B 3D 2B 7C 2E 7C	2B+  rect_style	db '+=+|.|+=+$'
     14	      3D 2B 24
     15
     16	0029			     .code
     17				     org 100h
     18
     19	0100			     start:
     20
     21	0100  B4 6E			     mov ah, 01101110b
     22	0102  BE 001Fr			     mov si, offset rect_style
     23	0105  BB 000A			     mov bx, 10d
     24	0108  B9 0032			     mov cx, 50d
     25	010B  BA B800			     mov dx, VIDEOSEG
     26	010E  8E C2			     mov es, dx
     27	0110  BF 0654			     mov di, (10d * 80d	+ 10d) * 2d
     28	0113  E8 0032			     call draw_rect
     29
     30	0116  B4 CE			     mov ah, 11001110b
     31	0118  BE 0000r			     mov si, offset tablet_string
     32	011B  B9 001E			     mov cx, 30d
     33	011E  BF 06F6			     mov di, (11d * 80d	+ 11d) * 2d
     34	0121  E8 0056			     call draw_string
     35
     36
     37
     38
     39	0124  B8 4C00			     mov ax, 4c00h				     ;|
     40	0127  CD 21			     int 21h					     ;|	exit(0)
     41
     42
     43
     44				     ;##########################################
     45				     ;		     print_msg
     46				     ;------------------------------------------
     47	0129  42 72 65 61 6B 50	6F+  msg_string	db 'BreakPoint$'
     48	      69 6E 74 24
     49				     ;------------------------------------------
     50				     ; Print string,
     51				     ;	 placed	in msg_string asm variable
     52				     ; Entry: None
     53				     ; Exit: None
     54				     ; Destr: AX, DX
     55				     ;------------------------------------------
     56	0134			     print_msg	     proc
     57	0134  B4 09				     mov ah, 09h			     ;
Turbo Assembler	 Version 4.1	    02/11/25 19:44:49	    Page 2
tablet.asm



     58	0136  BA 0129r				     mov dx, offset msg_string		     ; dx = &msg_string
     59	0139  CD 21				     int 21h				     ; print(dx)
     60	013B  C3				     ret
     61	013C					     endp
     62				     ;------------------------------------------
     63				     ;##########################################
     64
     65
     66				     ;##########################################
     67				     ;		     draw_pat_line
     68				     ;------------------------------------------
     69				     ;------------------------------------------
     70				     ; Descr:
     71				     ;	     Draws a line by pattern
     72				     ; Entry:
     73				     ;	     AH	     ; color attr
     74				     ;	     DS:SI   ; line pattern addr
     75				     ;	     CX	     ; line length
     76				     ;	     ES:DI   ; line beginng addr
     77				     ; Desroy:
     78				     ;	     AL, BX, CX, SI, DI
     79				     ;------------------------------------------
     80	013C			     draw_pat_line   proc
     81	013C  FC				     cld				     ; DF = 0 (++)
     82
     83	013D  AC				     lodsb				     ; al = ds:[si++]
     84	013E  AB				     stosw				     ; es:[di++] = ax
     85	013F  83 E9 02				     sub cx, 2d				     ; cx -= 2 for first, last char
     86
     87	0142  AC				     lodsb				     ; al = ds:[si++]
     88
     89	0143  F3> AB				     rep stosw				     ; while (CX != 0) {es:[di+=2] = ax}
     90
     91	0145  AC				     lodsb				     ; al = ds:[si++]
     92	0146  AB				     stosw				     ; es:[di+=2] = al
     93
     94	0147  C3				     ret
     95	0148					     endp
     96				     ;------------------------------------------
     97				     ;##########################################
     98
     99
    100
    101
    102
    103
    104
    105				     ;##########################################
    106				     ;		     draw_rect
    107				     ;------------------------------------------
    108				     ;------------------------------------------
    109				     ; Descr:
    110				     ;	     Draws rectangle by	pattern
    111				     ; Entry:
    112				     ;	     AH	     - color attr
    113				     ;	     DS:SI   - addr of pattern
    114				     ;	     BX	     - rectangle height
Turbo Assembler	 Version 4.1	    02/11/25 19:44:49	    Page 3
tablet.asm



    115				     ;	     CX	     - rectangle width
    116				     ;
    117				     ;	     ES:DI   - rectangle upper left corner
    118				     ;------------------------------------------
    119	0148			     draw_rect	     proc
    120	0148  53				     push bx				     ;|
    121	0149  51				     push cx				     ;|reg saving
    122	014A  57				     push di				     ;|
    123
    124	014B  E8 FFEE				     call draw_pat_line			     ; call draw_pat_line
    125
    126	014E  5F				     pop di				     ;|
    127	014F  59				     pop cx				     ;|reg restoring
    128	0150  5B				     pop bx				     ;|
    129
    130	0151  81 C7 00A0			     add di, 160			     ;|next line
    131	0155  83 EB 02				     sub bx, 2				     ;|
    132
    133	0158			     @@while:;-----------------------------------------------; while (BX > 0) {
    134	0158  53				     push bx				     ;|
    135	0159  51				     push cx				     ;|	     reg saving
    136	015A  57				     push di				     ;|
    137
    138	015B  56				     push si				     ;	     save pattern middle triad addr
    139
    140	015C  E8 FFDD				     call draw_pat_line			     ;	     call draw_pat_line
    141
    142	015F  5E				     pop si				     ;	     restore patterm middle triad   +
    143				     addr
    144
    145	0160  5F				     pop di				     ;|
    146	0161  59				     pop cx				     ;|	     reg restoring
    147	0162  5B				     pop bx				     ;|
    148
    149	0163  81 C7 00A0			     add di, 160			     ;|	     next line
    150	0167  4B				     dec bx				     ;|
    151	0168  83 FB 00				     cmp bx, 0				     ;	     if	dx > 0 -> jump @@while
    152	016B  7F EB		     jg	@@while;---------------------------------------------; while end }
    153
    154	016D  83 C6 03				     add  si, 3d
    155	0170  53				     push bx				     ;|
    156	0171  51				     push cx				     ;|reg saving
    157	0172  57				     push di				     ;|
    158
    159	0173  E8 FFC6				     call draw_pat_line			     ; call draw_pat_line
    160
    161	0176  5F				     pop di				     ;|
    162	0177  59				     pop cx				     ;|reg restoring
    163	0178  5B				     pop bx				     ;|
    164
    165	0179  C3				     ret
    166	017A					     endp
    167				     ;------------------------------------------
    168				     ;##########################################
    169
    170				     ;##########################################
    171				     ;		     draw_string
Turbo Assembler	 Version 4.1	    02/11/25 19:44:49	    Page 4
tablet.asm



    172				     ;------------------------------------------
    173				     ;------------------------------------------
    174				     ; Descr:
    175				     ;	     Draws a string by addr ES:DI
    176				     ; Entry:
    177				     ;	     AH	     ; color attr
    178				     ;	     DS:SI   ; string memory addr
    179				     ;	     CX	     ; string length
    180				     ;	     ES:DI   ; line beginning addr
    181				     ; Desroy:
    182				     ;	     AL, BX, CX, SI, DI
    183				     ;------------------------------------------
    184	017A			     draw_string     proc
    185	017A  FC				     cld				     ; DF = 0 (++)
    186	017B			     @@while:;-----------------------------------------------; while (CX != 0) {
    187	017B  AC				     lodsb				     ;	     al	= ds:[si++]
    188	017C  AB				     stosw				     ;	     es:[di++] = ax
    189	017D  E2 FC				     loop @@while
    190				     ;-------------------------------------------------------; while end }
    191
    192	017F  C3				     ret
    193	0180					     endp
    194				     ;------------------------------------------
    195				     ;##########################################
    196
    197				     end start
Turbo Assembler	 Version 4.1	    02/11/25 19:44:49	    Page 5
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/11/25"
??FILENAME			  Text	 "tablet  "
??TIME				  Text	 "19:44:49"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@WHILE				  Near	 DGROUP:0158
@@WHILE				  Near	 DGROUP:017B
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 TABLET
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
DRAW_PAT_LINE			  Near	 DGROUP:013C
DRAW_RECT			  Near	 DGROUP:0148
DRAW_STRING			  Near	 DGROUP:017A
MSG_STRING			  Byte	 DGROUP:0129
PRINT_MSG			  Near	 DGROUP:0134
RECT_STYLE			  Byte	 DGROUP:001F
START				  Near	 DGROUP:0100
TABLET_STRING			  Byte	 DGROUP:0000
VIDEOSEG			  Number B800

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0029 Word	  Public  DATA
  _TEXT				  16  0180 Word	  Public  CODE
